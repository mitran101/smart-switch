<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SwitchPilot - Stop Overpaying on Energy</title>
<style>
body {margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#0c0e1f;color:#fff;overflow-x:hidden;background-image:linear-gradient(rgba(99,102,241,0.12) 1px, transparent 1px), linear-gradient(90deg, rgba(236,72,153,0.12) 1px, transparent 1px);background-size:70px 70px;}

/* HERO */
.hero {position:relative;padding:8.5rem 2rem 6rem;overflow:hidden;background:#0c0e1f;} 
.energy-grid {position:absolute;inset:0;background-image:linear-gradient(rgba(99,102,241,0.12) 1px,transparent 1px),linear-gradient(90deg,rgba(236,72,153,0.12) 1px,transparent 1px);background-size:70px 70px;opacity:.10;animation:energyGridMove 18s linear infinite;} 
@keyframes energyGridMove {0%{transform:translateY(0)}100%{transform:translateY(60px)}}
.floating-symbols {position:absolute;inset:0;pointer-events:none;}
.symbol {position:absolute;font-size:3rem;opacity:.85;animation:drift 10s ease-in-out infinite;pointer-events:none;filter:drop-shadow(0 0 20px rgba(99,102,241,0.6));} 
@keyframes drift {0%,100%{transform:translate(0,0) rotate(0)}50%{transform:translate(20px,-30px) rotate(10deg)}}

/* Glowing pulse animation for energy symbols */
.symbol:nth-child(1), .symbol:nth-child(4) {
    animation: drift 10s ease-in-out infinite, energyGlow 2s ease-in-out infinite;
}
@keyframes energyGlow {
    0%, 100% { opacity: 0.6; filter: drop-shadow(0 0 20px rgba(99,102,241,0.6)); }
    50% { opacity: 1; filter: drop-shadow(0 0 40px rgba(236,72,153,0.9)); }
}

.symbol:nth-child(1){left:55%;top:14%}
.symbol:nth-child(2){left:70%;top:10%}
.symbol:nth-child(3){left:50%;top:65%}
.symbol:nth-child(4){left:85%;top:28%}
.symbol:nth-child(5){left:50%;top:35%}

.hero-content {max-width:1200px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:4rem;align-items:center;position:relative;z-index:5;} 
.badge {display:inline-block;background:rgba(255,255,255,0.15);padding:.7rem 1.4rem;border-radius:50px;margin-bottom:1.5rem;font-weight:700;font-size:.9rem;backdrop-filter:blur(10px);} 
.hero-text h1 {font-size:4rem;font-weight:900;margin:0 0 1.5rem;text-shadow:0 5px 30px rgba(99,102,241,0.5);} 
.hero-text p {font-size:1.25rem;opacity:.85;line-height:1.6;max-width:90%;} 
.pilot-container {position:relative;display:flex;justify-content:center;align-items:center;} 
.pilot-character {font-size:18rem;animation:pilotFloat 4s infinite ease-in-out;filter:drop-shadow(0 30px 60px rgba(99,102,241,0.55));} 
@keyframes pilotFloat {0%,100%{transform:translateY(0) rotate(-6deg)}50%{transform:translateY(-35px) rotate(6deg)}}
.destination-tag {position:absolute;bottom:2rem;right:2rem;background:rgba(255,255,255,0.95);color:#1a1a2e;padding:1.2rem 2rem;border-radius:20px;font-weight:700;box-shadow:0 20px 60px rgba(0,0,0,0.4);} 
.destination-tag strong {font-size:1.8rem;color:#6366f1;display:block;margin-top:.3rem;} 

/* WAITLIST */
.waitlist-form {max-width:700px;margin:3.5rem auto 4rem;background:#ffffff;color:#1a1a2e;padding:3rem;border-radius:30px;box-shadow:0 25px 80px rgba(0,0,0,0.2);} 
.waitlist-form h3 {font-size:2rem;font-weight:900;margin-bottom:1rem;color:#1a1a2e;} 
.waitlist-form p {opacity:.8;margin-bottom:1.5rem;font-size:1.05rem;color:#1a1a2e;} 
.form-group input {width:100%;padding:1.2rem;border-radius:15px;border:2px solid #eee;background:#fafafa;font-size:1rem;color:#1a1a2e;box-sizing:border-box;} 
.submit-btn {width:100%;padding:1.2rem;border:none;border-radius:15px;font-size:1.2rem;font-weight:700;background:linear-gradient(90deg,#6366f1,#ec4899);color:#fff;cursor:pointer;box-shadow:0 10px 30px rgba(236,72,153,0.3);margin-top:1rem;} 

/* Signup counter animation */
.signup-counter {
    animation: counterFadeIn 0.6s ease-out;
}
@keyframes counterFadeIn {
    0% { opacity: 0; transform: translateY(-10px); }
    100% { opacity: 1; transform: translateY(0); }
}
#signupCount {
    display: inline-block;
    min-width: 2ch;
} 

/* INSIGHTS */
.insights {background:#0f1329;padding:6rem 2rem;text-align:center;position:relative;overflow:hidden;} 

/* Animated circuit lines */
.insights::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, #6366f1, transparent);
    animation: scanline 3s linear infinite;
}
.insights::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, #ec4899, transparent);
    animation: scanline 3s linear infinite reverse;
}
@keyframes scanline {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.insights h2 {font-size:3rem;font-weight:900;margin-bottom:1rem;position:relative;z-index:2;} 
.topics {max-width:1200px;margin:3rem auto 0;display:grid;grid-template-columns:repeat(2,1fr);gap:2.5rem;} 
.topic {background:#11162e;padding:2rem 2.2rem;border-radius:22px;border:1px solid rgba(255,255,255,0.08);box-shadow:0 10px 40px rgba(0,0,0,0.45);display:flex;flex-direction:column;justify-content:flex-start;cursor:pointer;transition:.3s;position:relative;overflow:hidden;} 

/* Glowing edge on hover */
.topic::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 22px;
    padding: 2px;
    background: linear-gradient(135deg, #6366f1, #ec4899);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0;
    transition: opacity 0.3s;
}
.topic:hover::before {
    opacity: 1;
}

.topic:hover {transform:translateY(-6px);box-shadow:0 15px 50px rgba(99,102,241,0.4);} 
.topic h3 {font-size:1.4rem;margin-bottom:0.8rem;margin-top:0;line-height:1.3;} 
.topic p {opacity:.85;line-height:1.55;font-size:1.05rem;margin:0 0 0.8rem 0;} 
.topic p:last-child {margin-bottom:0;font-size:0.95rem;} 

/* STATS */
.stats {max-width:1200px;margin:6rem auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:3rem;text-align:center;padding:0 2rem;position:relative;} 
.stat-number {font-size:3rem;font-weight:900;background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;} 

/* CTA */
.final-cta {text-align:center;padding:6rem 2rem;background:#11152d;position:relative;overflow:hidden;} 

/* Animated grid overlay */
.final-cta::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: 
        linear-gradient(rgba(99,102,241,0.08) 1px, transparent 1px),
        linear-gradient(90deg, rgba(236,72,153,0.08) 1px, transparent 1px);
    background-size: 50px 50px;
    animation: gridSlide 15s linear infinite;
}
@keyframes gridSlide {
    0% { transform: translate(0, 0); }
    100% { transform: translate(50px, 50px); }
}

.final-cta h2 {font-size:3rem;font-weight:900;margin-bottom:1.5rem;position:relative;z-index:2;} 
.final-cta p {max-width:800px;margin:0 auto 2rem;opacity:.85;font-size:1.1rem;line-height:1.6;position:relative;z-index:2;} 
.cta-btn {padding:1.3rem 3rem;border:none;border-radius:20px;font-size:1.3rem;font-weight:700;background:linear-gradient(135deg,#6366f1,#ec4899);color:#fff;cursor:pointer;box-shadow:0 10px 40px rgba(236,72,153,0.4);transition:.3s;position:relative;z-index:2;} 
.cta-btn:hover {transform:translateY(-3px);box-shadow:0 15px 50px rgba(236,72,153,0.5);}

/* MOBILE RESPONSIVE */
@media (max-width: 968px) {
    .hero {padding:6rem 1.5rem 4rem;}
    .hero-content {grid-template-columns:1fr;gap:2rem;}
    .hero-text h1 {font-size:2.5rem;}
    .hero-text p {font-size:1.1rem;max-width:100%;}
    .pilot-character {font-size:12rem;}
    .destination-tag {position:static;margin:2rem auto 0;max-width:280px;}
    
    /* Hide floating symbols on mobile - they overlap */
    .floating-symbols {display:none;}
    
    /* Vision/Mission boxes stack on mobile */
    .vision-mission-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem !important;
        padding: 0 1.5rem !important;
    }
    
    .waitlist-form {padding:2rem;margin:2rem 1.5rem;}
    .waitlist-form h3 {font-size:1.6rem;}
    
    .insights h2, .final-cta h2 {font-size:2rem;}
    .topics {grid-template-columns:1fr;gap:1.5rem;}
    .topic {height:auto;min-height:200px;}
    
    .stats {grid-template-columns:1fr;gap:2rem;}
    .stat-number {font-size:2.5rem;}
    
    /* Game section responsive */
    section:has(a[href="game.html"]) > div {
        padding: 2.5rem 2rem !important;
    }
    section:has(a[href="game.html"]) h2 {
        font-size: 1.8rem !important;
    }
    section:has(a[href="game.html"]) p {
        font-size: 1rem !important;
    }
    
    .final-cta {padding:4rem 1.5rem;}
    .final-cta p {font-size:1rem;}
    .cta-btn {padding:1rem 2rem;font-size:1.1rem;width:100%;max-width:300px;}
}

@media (max-width: 480px) {
    .hero-text h1 {font-size:2rem;}
    .pilot-character {font-size:10rem;}
    .waitlist-form h3 {font-size:1.4rem;}
    .insights, .final-cta {padding:4rem 1rem;}
    
    /* Responsive logo */
    .top-logo-wrapper {left:15px !important;gap:6px !important;}
    .logo-icon {font-size:1.8rem !important;}
    .logo-text {font-size:1.5rem !important;}
}
</style>
</head>
<body>

<!-- TOP LEFT LOGO -->
<div class="top-logo-wrapper" style="position:absolute; top:25px; left:30px; z-index:9999; display:flex; align-items:center; gap:10px;">
    <span class="logo-icon" style="font-size:2.3rem; filter:drop-shadow(0 5px 10px rgba(0,0,0,0.4));">âœˆï¸âš¡</span>
    <span class="logo-text" style="font-size:1.9rem; font-weight:900; letter-spacing:-0.5px;">SwitchPilot</span>
</div>

<section class="hero">
<div class="energy-grid"></div>
<div class="floating-symbols">
<div class="symbol">âš¡</div><div class="symbol">ğŸ’·</div><div class="symbol">ğŸ”Œ</div><div class="symbol">ğŸ’¡</div><div class="symbol">ğŸ“ˆ</div>
</div>
<div class="hero-content">
<div class="hero-text">
<div class="badge">ğŸš€ Building Together</div>
<h1>Your Flight to Better Energy Deals</h1>
</div>
<div class="pilot-container">
<div class="pilot-character">âœˆï¸</div>
<div class="destination-tag"><span>Next Destination:</span><strong>Â£200+ Savings</strong></div>
</div>
</div>

<!-- Vision & Mission Boxes -->
<div class="vision-mission-grid" style="max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:2rem;padding:0 2rem;position:relative;z-index:5;">
  <div style="background:rgba(17,22,46,0.95);padding:2rem;border-radius:22px;border:2px solid rgba(99,102,241,0.3);box-shadow:0 15px 50px rgba(0,0,0,0.4);">
    <div style="display:flex;align-items:center;gap:0.6rem;margin-bottom:1rem;">
      <span style="font-size:1.8rem;">ğŸ”®</span>
      <h3 style="margin:0;font-size:1.3rem;font-weight:800;background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Our Vision</h3>
    </div>
    <p style="margin:0;font-size:1.4rem;font-weight:700;line-height:1.4;margin-bottom:1rem;">Putting the power back in your hands</p>
    <p style="margin:0;font-size:1.05rem;line-height:1.6;opacity:0.85;">An energy market where customers are informed, empowered, and never overpay. Where transparency is the norm and switching is effortless.</p>
  </div>
  <div style="background:rgba(17,22,46,0.95);padding:2rem;border-radius:22px;border:2px solid rgba(236,72,153,0.3);box-shadow:0 15px 50px rgba(0,0,0,0.4);">
    <div style="display:flex;align-items:center;gap:0.6rem;margin-bottom:1rem;">
      <span style="font-size:1.8rem;">ğŸš€</span>
      <h3 style="margin:0;font-size:1.3rem;font-weight:800;background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Our Mission</h3>
    </div>
    <p style="margin:0;font-size:1.05rem;line-height:1.6;opacity:0.9;">Build a free auto-switching service that finds the cheapest energy deals for you. But first, we need <strong>10,000 willing participants</strong> to show we have power in numbersâ€”so we can bring back the power to energy customers across the UK.</p>
  </div>
</div>
</section>

<!-- WHO WE ARE -->
<section style="max-width:900px;margin:5rem auto 0;padding:0 2rem;">
<div style="background:rgba(17,22,46,0.95);padding:3rem;border-radius:22px;border:1px solid rgba(255,255,255,0.08);box-shadow:0 20px 60px rgba(0,0,0,0.4);">
  <h2 style="font-size:2.2rem;font-weight:900;margin-bottom:1.5rem;text-align:center;">Who We Are</h2>
  
  <p style="font-size:1.1rem;line-height:1.7;margin-bottom:1.2rem;opacity:0.9;">
    We're just two people who've been working in the UK energy industry recently. Before this? <strong>Zero knowledge about energy bills.</strong>
  </p>
  
  <p style="font-size:1.1rem;line-height:1.7;margin-bottom:1.2rem;opacity:0.9;">
    Now? We've learned things that shocked us. And we can't unsee them.
  </p>
  
  <div style="background:rgba(99,102,241,0.1);padding:1.5rem;border-radius:15px;border-left:4px solid #6366f1;margin:1.5rem 0;">
    <p style="font-size:1rem;line-height:1.6;margin:0;opacity:0.95;">
      Did you know you're paying wind farms to turn off when it's too windy (<strong>constraint payments</strong>), whilst funding them through <strong>CfDs</strong>? Or funding nuclear plant investors <strong>before it's even built</strong> (Nuclear RAB)? Through the Warm Home Discount, you're subsidising other people's discounts even if you don't qualify.
    </p>
  </div>
  
  <p style="font-size:1.1rem;line-height:1.7;margin-top:1.2rem;margin-bottom:0;opacity:0.9;">
    None of this is explained on your bill. But you're paying for all of it. That's why we're building SwitchPilot <strong>WITH you</strong>â€”educating you while creating a service that actually works for you. Because an informed customer creates a more competitive market for everyone.
  </p>
</div>
</section>

<div class="waitlist-form">
<div class="signup-counter" style="display:flex;flex-direction:column;align-items:center;gap:0.8rem;margin-bottom:1.5rem;padding:1.2rem 1.5rem;background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(236,72,153,0.1));border-radius:15px;border:2px solid rgba(99,102,241,0.2);">
  <div style="display:flex;align-items:center;gap:0.5rem;">
    <span style="font-size:1.5rem;">ğŸ‘¥</span>
    <span style="font-size:1rem;color:#1a1a2e;opacity:0.8;">Already on board:</span>
    <div style="display:inline-flex;align-items:center;gap:0.3rem;">
      <span id="signupCount" style="font-size:1.8rem;font-weight:900;background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">0</span>
      <span style="font-size:1rem;color:#1a1a2e;opacity:0.8;">pilots</span>
    </div>
  </div>
  <div style="width:100%;background:rgba(99,102,241,0.15);border-radius:10px;height:12px;overflow:hidden;">
    <div id="progressBar" style="width:0%;height:100%;background:linear-gradient(90deg,#6366f1,#ec4899);border-radius:10px;transition:width 0.5s ease;"></div>
  </div>
  <div style="display:flex;align-items:center;gap:0.5rem;">
    <span style="font-size:1rem;color:#1a1a2e;opacity:0.8;">ğŸ¯ Only</span>
    <div style="display:inline-flex;align-items:center;gap:0.3rem;">
      <span id="spotsRemaining" style="font-size:1.4rem;font-weight:900;background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">10,000</span>
      <span style="font-size:1rem;color:#1a1a2e;opacity:0.8;">spots left for early access</span>
    </div>
  </div>
</div>
<h3>Join the Flight Crew âœˆï¸</h3>
<p>Get weekly insights + early access when we launch</p>
<form onsubmit="handleSubmit(event)">
<div class="form-group"><input type="email" placeholder="Your email address" required /></div>
<button type="submit" class="submit-btn">Get Weekly Insights</button>
</form>
<p style="margin-top:1rem;font-size:.9rem;opacity:.6;">ğŸ”’ Unsubscribe anytime. We respect your inbox.</p>
</div>

<section class="insights">
<h2>Recent Insights</h2>
<p style="opacity:.85;margin-top:.5rem;margin-bottom:3rem;font-size:1.2rem;position:relative;z-index:2;">Here's what our community is learning about right now</p>
<div class="topics">

<div class="topic" onclick="window.open('nuclear-rab.html','_blank')">
<h3>âš›ï¸ Nuclear RAB Charge</h3>
<p>What's being added to bills from 2026 â€“ and why you're paying for a nuclear plant before it's built</p>
<p style="font-size:.9rem;opacity:.7;">ğŸ“… 22 Nov 2025</p>
</div>

<div class="topic" onclick="window.open('article.html','_blank')">
<h3>ğŸ”† Warm Home Discount Expansion</h3>
<p>What's changing from winter 2025-26 and how it affects your bills â€“ plus why competition is heating up</p>
<p style="font-size:.9rem;opacity:.7;">ğŸ“… 25 Oct 2025</p>
</div>

</div>
</section>

<section class="stats">
<div>
  <div class="stat-number">65%</div>
  <div>of UK could save more</div>
</div>
<div>
  <div class="stat-number">Â£200+</div>
  <div>potential yearly savings</div>
</div>
<div>
  <div class="stat-number">You</div>
  <div>shape what we build</div>
</div>
</section>

<!-- GAME SECTION -->
<section style="max-width:1200px;margin:6rem auto;padding:0 2rem;text-align:center;">
<div style="background:#11162e;padding:3rem;border-radius:30px;border:2px solid rgba(99,102,241,0.3);box-shadow:0 20px 60px rgba(0,0,0,0.4);position:relative;overflow:hidden;">
  
  <!-- Animated background -->
  <div style="position:absolute;inset:0;background-image:linear-gradient(rgba(99,102,241,0.08) 1px, transparent 1px),linear-gradient(90deg, rgba(236,72,153,0.08) 1px, transparent 1px);background-size:40px 40px;opacity:0.5;animation:gridSlide 20s linear infinite;pointer-events:none;"></div>
  
  <div style="position:relative;z-index:2;">
    <div style="font-size:3rem;margin-bottom:1rem;">âœˆï¸âš¡ğŸ’·</div>
    <h2 style="font-size:2.5rem;font-weight:900;margin-bottom:1rem;">Whilst We Build You a Service That Works for YOU</h2>
    <p style="font-size:1.1rem;opacity:0.85;margin-bottom:1.5rem;max-width:600px;margin-left:auto;margin-right:auto;">Why not play a fun game? Move your mouse to pilot the plane, catch energy savings, and avoid obstacles!</p>
    
    <div id="gameStartScreen" style="margin-bottom:1.5rem;">
      <button onclick="startMainGame()" style="padding:1.3rem 3rem;background:linear-gradient(135deg,#6366f1,#ec4899);color:#fff;border:none;border-radius:20px;font-size:1.3rem;font-weight:700;cursor:pointer;box-shadow:0 10px 40px rgba(236,72,153,0.4);">ğŸ® Play Now</button>
    </div>
    
    <canvas id="gameCanvas" width="700" height="400" style="border:3px solid #6366f1;border-radius:15px;background:#0a0c1a;max-width:100%;cursor:none;display:none;margin:0 auto 1.5rem;"></canvas>
    
    <div style="display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;">
      <div style="padding:1rem 2rem;background:rgba(99,102,241,0.2);border-radius:15px;border:2px solid rgba(99,102,241,0.3);">
        <div style="font-size:0.9rem;opacity:0.7;margin-bottom:0.3rem;">Score</div>
        <div id="gameScore" style="font-size:1.8rem;font-weight:900;background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">0</div>
      </div>
      <div style="padding:1rem 2rem;background:rgba(99,102,241,0.2);border-radius:15px;border:2px solid rgba(99,102,241,0.3);">
        <div style="font-size:0.9rem;opacity:0.7;margin-bottom:0.3rem;">High Score</div>
        <div id="gameHighScore" style="font-size:1.8rem;font-weight:900;background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">0</div>
      </div>
    </div>
    
    <div id="gameOverScreen" style="display:none;margin-top:2rem;">
      <h3 style="font-size:2rem;margin-bottom:1rem;color:#ec4899;">Game Over! ğŸ’¥</h3>
      <p style="font-size:1.3rem;margin-bottom:1rem;">Final Score: <span id="finalGameScore" style="color:#6366f1;font-weight:900;">0</span></p>
      <button onclick="restartMainGame()" style="padding:1rem 2.5rem;background:linear-gradient(135deg,#6366f1,#ec4899);color:#fff;border:none;border-radius:15px;font-size:1.2rem;font-weight:700;cursor:pointer;">Play Again</button>
    </div>
  </div>
</div>
</section>

<section class="final-cta">
<h2>We're Building This Together</h2>
<p>65% of UK households are on Standard Variable Tariffs and could save Â£200+ per year by switching. Even those on fixed tariffs often miss better deals. We're creating an automated service that handles this for you â€” but we need your input to build what actually works.</p>
<button class="cta-btn" onclick="document.querySelector('.hero').scrollIntoView({behavior:'smooth'})">Join the Community</button>
</section>

<footer class="footer" style="text-align:center;padding:3rem 2rem;background:#0c0e1f;color:#fff;opacity:0.8;">
<p>ğŸ’Œ Weekly energy insights delivered to your inbox</p>
<p style="margin-top:1rem;">Â© 2025 SwitchPilot. Making energy bills make sense.</p>
</footer>

<script>
// Google Apps Script URL
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzE528vYoas8bb2UrvJuBOHkoOOStV3KIAGhPjiWa5dhNB0BhEmfEeK1wbtFJRP257bFw/exec';

// Target number for countdown
const TARGET_SIGNUPS = 10000;

// Initialize signup counter - fetch from Google Sheets
let signupCount = 0;

function updateCounterDisplay(count) {
    const countElement = document.getElementById('signupCount');
    const spotsElement = document.getElementById('spotsRemaining');
    const progressBar = document.getElementById('progressBar');
    
    if (countElement) countElement.textContent = count.toLocaleString();
    if (spotsElement) spotsElement.textContent = Math.max(0, TARGET_SIGNUPS - count).toLocaleString();
    if (progressBar) progressBar.style.width = Math.min(100, (count / TARGET_SIGNUPS) * 100) + '%';
}

// Fetch global count on page load
fetch(SCRIPT_URL)
    .then(response => response.json())
    .then(data => {
        signupCount = data.count || 0;
        updateCounterDisplay(signupCount);
    })
    .catch(err => {
        console.log('Could not fetch signup count:', err);
        updateCounterDisplay(0);
    });

function animateCounter(element, newValue) {
    element.style.transform = 'scale(1.3)';
    element.style.transition = 'transform 0.3s ease';
    element.textContent = newValue.toLocaleString();
    setTimeout(() => {
        element.style.transform = 'scale(1)';
    }, 300);
}

function handleSubmit(e) {
    e.preventDefault();
    const email = e.target.querySelector('input').value;
    const form = e.target.closest('.waitlist-form');
    
    // Optimistically increment counter (immediate feedback)
    signupCount++;
    const counterElement = document.getElementById('signupCount');
    if (counterElement) {
        animateCounter(counterElement, signupCount);
    }
    updateCounterDisplay(signupCount);
    
    // Show loading
    form.innerHTML = '<div style="text-align:center;padding:2rem;"><p style="color:#666;font-size:1.1rem;">Adding you to the flight crew...</p></div>';
    
    // Send to Google Sheets
    fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email })
    })
    .then(() => {
        form.innerHTML = `
            <div style="text-align:center;padding:2rem;">
                <div style="font-size:4rem;margin-bottom:1rem;">ğŸ‰</div>
                <h3 style="color:#6366f1;margin-bottom:0.5rem;font-size:1.8rem;">Welcome Aboard!</h3>
                <p style="color:#666;">Your first weekly insight is taking off to <strong>${email}</strong></p>
            </div>
        `;
    })
    .catch(() => {
        form.innerHTML = `
            <div style="text-align:center;padding:2rem;">
                <div style="font-size:4rem;margin-bottom:1rem;">ğŸ‰</div>
                <h3 style="color:#6366f1;margin-bottom:0.5rem;font-size:1.8rem;">Welcome Aboard!</h3>
                <p style="color:#666;">Your first weekly insight is taking off to <strong>${email}</strong></p>
            </div>
        `;
    });
}

// GAME CODE
const gameCanvas = document.getElementById('gameCanvas');
if (gameCanvas) {
    const ctx = gameCanvas.getContext('2d');
    
    let gameRunning = false;
    let gameScore = 0;
    let gameHighScore = 0;
    document.getElementById('gameHighScore').textContent = gameHighScore;
    
    const player = {
        x: gameCanvas.width / 2,
        y: gameCanvas.height - 80,
        size: 35,
        emoji: 'âœˆï¸'
    };
    
    const goodItems = ['âš¡', 'ğŸ’·', 'ğŸ”‹', 'ğŸ’¡'];
    const badItems = ['ğŸ’¥', 'ğŸŒ©ï¸'];
    const items = [];
    
    let mouseX = player.x;
    let mouseY = player.y;
    
    gameCanvas.addEventListener('mousemove', (e) => {
        const rect = gameCanvas.getBoundingClientRect();
        mouseX = (e.clientX - rect.left) * (gameCanvas.width / rect.width);
        mouseY = (e.clientY - rect.top) * (gameCanvas.height / rect.height);
    });
    
    // Improved touch controls with finger offset
    gameCanvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const rect = gameCanvas.getBoundingClientRect();
        const touch = e.touches[0];
        mouseX = (touch.clientX - rect.left) * (gameCanvas.width / rect.width);
        mouseY = (touch.clientY - rect.top) * (gameCanvas.height / rect.height) - 60;
    });
    
    gameCanvas.addEventListener('touchmove', (e) => {
        e.preventDefault();
        const rect = gameCanvas.getBoundingClientRect();
        const touch = e.touches[0];
        mouseX = (touch.clientX - rect.left) * (gameCanvas.width / rect.width);
        mouseY = (touch.clientY - rect.top) * (gameCanvas.height / rect.height) - 60;
    });
    
    gameCanvas.addEventListener('touchend', (e) => {
        e.preventDefault();
    });
    
    function createItem() {
        const isGood = Math.random() > 0.25;
        const emoji = isGood 
            ? goodItems[Math.floor(Math.random() * goodItems.length)]
            : badItems[Math.floor(Math.random() * badItems.length)];
        
        items.push({
            x: Math.random() * (gameCanvas.width - 40),
            y: -40,
            size: 30,
            emoji: emoji,
            speed: 2 + Math.random() * 2,
            isGood: isGood
        });
    }
    
    function drawEmoji(emoji, x, y, size) {
        ctx.font = `${size}px Arial`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(emoji, x, y);
    }
    
    function checkCollision(item) {
        const dist = Math.sqrt(
            Math.pow(player.x - item.x, 2) + 
            Math.pow(player.y - item.y, 2)
        );
        return dist < (player.size + item.size) / 2;
    }
    
    function updateGame() {
        if (!gameRunning) return;
        
        ctx.fillStyle = '#0a0c1a';
        ctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
        
        player.x += (mouseX - player.x) * 0.15;
        player.y += (mouseY - player.y) * 0.15;
        
        player.x = Math.max(20, Math.min(gameCanvas.width - 20, player.x));
        player.y = Math.max(20, Math.min(gameCanvas.height - 20, player.y));
        
        drawEmoji(player.emoji, player.x, player.y, player.size);
        
        for (let i = items.length - 1; i >= 0; i--) {
            const item = items[i];
            item.y += item.speed;
            
            drawEmoji(item.emoji, item.x, item.y, item.size);
            
            if (checkCollision(item)) {
                if (item.isGood) {
                    gameScore += 10;
                    document.getElementById('gameScore').textContent = gameScore;
                    
                    ctx.fillStyle = 'rgba(99, 102, 241, 0.3)';
                    ctx.beginPath();
                    ctx.arc(item.x, item.y, 50, 0, Math.PI * 2);
                    ctx.fill();
                } else {
                    endGame();
                }
                items.splice(i, 1);
            }
            else if (item.y > gameCanvas.height + 40) {
                items.splice(i, 1);
            }
        }
        
        if (Math.random() < 0.02) {
            createItem();
        }
        
        requestAnimationFrame(updateGame);
    }
    
    function endGame() {
        gameRunning = false;
        
        if (gameScore > gameHighScore) {
            gameHighScore = gameScore;
            document.getElementById('gameHighScore').textContent = gameHighScore;
        }
        
        document.getElementById('finalGameScore').textContent = gameScore;
        document.getElementById('gameOverScreen').style.display = 'block';
        document.getElementById('gameCanvas').style.display = 'none';
    }
    
    window.startMainGame = function() {
        gameRunning = true;
        gameScore = 0;
        items.length = 0;
        player.x = gameCanvas.width / 2;
        player.y = gameCanvas.height - 80;
        document.getElementById('gameScore').textContent = 0;
        document.getElementById('gameStartScreen').style.display = 'none';
        document.getElementById('gameCanvas').style.display = 'block';
        updateGame();
        
        for (let i = 0; i < 3; i++) {
            setTimeout(createItem, i * 500);
        }
    };
    
    window.restartMainGame = function() {
        document.getElementById('gameOverScreen').style.display = 'none';
        startMainGame();
    };
}
</script>

</body>
</html>
