<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recreate Your Energy Bill | SwitchPilot</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --sp-slate: #1E293B;
            --sp-slate-light: #475569;
            --sp-green: #10B981;
            --sp-green-dark: #059669;
            --sp-green-light: #D1FAE5;
            --sp-amber: #F59E0B;
            --sp-bg: #F8FAFC;
            --sp-card: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--sp-bg);
            color: var(--sp-slate);
            line-height: 1.6;
            padding: 0;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Navigation matching TNUoS style */
        .top-nav {
            background: var(--sp-slate);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-logo {
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-weight: 700;
            color: white;
            transition: opacity 0.2s;
        }

        .top-logo:hover {
            opacity: 0.8;
        }

        .top-logo span:first-child {
            font-size: 1.6rem;
        }

        .top-logo span:last-child {
            font-size: 1.35rem;
        }

        .back-home {
            display: inline-block;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            border-radius: 30px;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .back-home:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        header {
            background: linear-gradient(135deg, var(--sp-slate) 0%, #0F172A 100%);
            color: white;
            padding: 4rem 2rem 3rem;
            position: relative;
            overflow: hidden;
            margin-bottom: 40px;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2310B981' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .header-content {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            text-align: center;
        }

        h1 {
            font-family: 'DM Serif Display', Georgia, serif;
            font-size: clamp(1.75rem, 5vw, 2.5rem);
            font-weight: 400;
            line-height: 1.2;
            margin-bottom: 1rem;
            color: white;
        }

        .subtitle {
            font-size: 1.15rem;
            color: #94A3B8;
            margin-bottom: 10px;
        }

        .intro {
            background: var(--sp-green-light);
            border-left: 4px solid var(--sp-green);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .fuel-section {
            background: var(--sp-card);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .fuel-sections-wrapper {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1000px) {
            .fuel-sections-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .fuel-section h2 {
            color: var(--sp-slate);
            margin-bottom: 20px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }

        .fuel-icon {
            font-size: 1.2em;
        }

        .rate-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9fb;
            border-radius: 10px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #6e6e73;
            font-size: 0.95em;
        }

        input[type="number"] {
            width: 100%;
            padding: 10px;
            background: white;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            color: #1d1d1f;
            font-size: 1em;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #a855f7;
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        }

        .appliance {
            background: #f9f9fb;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid #e8e8ed;
        }

        .fun-appliance {
            background: linear-gradient(135deg, #fef3f2 0%, #f0e7ff 100%);
            border: 2px solid #ec4899;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .appliance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .appliance-name {
            font-weight: 600;
            color: #1d1d1f;
            font-size: 1.1em;
        }

        .appliance-power {
            color: #6e6e73;
            font-size: 0.9em;
        }

        .slider-container {
            margin-bottom: 10px;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e8e8ed;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(168, 85, 247, 0.4);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(168, 85, 247, 0.4);
        }

        .usage-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #6e6e73;
            font-size: 0.9em;
        }

        .cost-display {
            color: #ec4899;
            font-weight: 600;
            font-size: 1.1em;
        }

        .summary {
            background: var(--sp-card);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .summary h2 {
            color: var(--sp-slate);
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 700;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #E2E8F0;
        }

        .summary-row:last-child {
            border-bottom: none;
            padding-top: 20px;
            margin-top: 10px;
            border-top: 2px solid var(--sp-green);
        }

        .summary-label {
            font-size: 1.1em;
            color: var(--sp-slate);
        }

        .summary-value {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--sp-green);
        }

        .total-row .summary-label,
        .total-row .summary-value {
            font-size: 1.4em;
            font-weight: 700;
        }

        .total-row .summary-value {
            color: var(--sp-green-dark);
        }

        .period-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .period-btn {
            padding: 10px 20px;
            background: white;
            border: 1px solid #E2E8F0;
            border-radius: 8px;
            color: var(--sp-slate);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            font-weight: 600;
        }

        .period-btn:hover {
            background: var(--sp-green-light);
            border-color: var(--sp-green);
        }

        .period-btn.active {
            background: var(--sp-green);
            border-color: var(--sp-green);
            color: white;
        }

        .note {
            background: #fef3f2;
            border-left: 4px solid #ec4899;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 0.9em;
            color: #6e6e73;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .fuel-section {
                padding: 20px;
            }

            .rate-inputs {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <a href="index.html" class="top-logo">
            <span>‚ö°</span>
            <span>SwitchPilot</span>
        </a>
        <a href="index.html" class="back-home">‚Üê Back to Home</a>
    </nav>

    <!-- Header -->
    <header>
        <div class="header-content">
            <h1>Recreate Your Energy Bill</h1>
            <p class="subtitle">See exactly how your daily usage adds up to your monthly bill</p>
        </div>
    </header>

    <div class="container">

        <div class="intro">
            <p><strong>Ever wondered where your energy bill actually comes from?</strong> This tool lets you recreate your typical energy usage with both gas and electricity. Adjust the sliders to match your daily routine and watch your bill build up in real-time.</p>
        </div>

        <div class="period-selector">
            <button class="period-btn active" onclick="setPeriod('day')">Daily Bill</button>
            <button class="period-btn" onclick="setPeriod('week')">Weekly Bill</button>
            <button class="period-btn" onclick="setPeriod('month')">Monthly Bill</button>
            <button class="period-btn" onclick="setPeriod('year')">Annual Bill</button>
        </div>

        <div class="period-selector" id="seasonToggle" style="margin-top: 10px;">
            <button class="period-btn season-btn active" onclick="setSeason('summer')" id="summerBtn">‚òÄÔ∏è Summer Period</button>
            <button class="period-btn season-btn" onclick="setSeason('winter')" id="winterBtn">‚ùÑÔ∏è Winter Period</button>
        </div>

        <div id="seasonNote" style="text-align: center; margin-bottom: 20px; margin-top: 10px;">
            <p style="font-size: 0.9em; color: var(--sp-slate-light);">
                Viewing <strong id="seasonLabel">Summer</strong> heating costs | Annual bill combines both seasons
            </p>
        </div>

        <div style="text-align: center; margin-bottom: 20px;">
            <button class="period-btn" id="funToggle" onclick="toggleFunAppliances()" style="background: var(--sp-green); color: white; border: none;">
                üéâ Show Essential Additions
            </button>
        </div>

        <!-- SUMMARY -->
        <div class="summary">
            <h2>Your Bill Breakdown</h2>
            <div class="summary-row">
                <span class="summary-label">Electricity Usage</span>
                <span class="summary-value" id="elecUsageCost">¬£0.00</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Electricity Standing Charge</span>
                <span class="summary-value" id="elecStandingCost">¬£0.00</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Gas Usage</span>
                <span class="summary-value" id="gasUsageCost">¬£0.00</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Gas Standing Charge</span>
                <span class="summary-value" id="gasStandingCost">¬£0.00</span>
            </div>
            <div class="summary-row total-row">
                <span class="summary-label">Total Energy Bill</span>
                <span class="summary-value" id="totalCost">¬£0.00</span>
            </div>
        </div>

        <!-- ANNUAL BILLING COMPARISON -->
        <div class="summary" style="margin-top: 30px;">
            <h2>Annual Direct Debit Comparison</h2>
            <p style="color: var(--sp-slate-light); margin-bottom: 20px; font-size: 0.95em;">
                See how your fixed monthly Direct Debit compares to actual seasonal consumption. This shows why you build up credit in summer and use it in winter.
            </p>
            
            <div style="margin-bottom: 25px;">
                <label style="display: block; margin-bottom: 8px; color: var(--sp-slate); font-weight: 600;">Set Your Monthly Direct Debit Amount</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <span style="font-size: 1.2em; color: var(--sp-slate);">¬£</span>
                    <input type="number" id="ddAmount" value="150" step="1" min="0" 
                           style="width: 120px; padding: 10px; border: 2px solid var(--sp-green); border-radius: 8px; font-size: 1.1em; font-weight: 600;"
                           oninput="calculateAnnualComparison()">
                    <span style="color: var(--sp-slate-light);">per month</span>
                </div>
            </div>

            <div style="background: var(--sp-bg); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div>
                        <div style="font-size: 0.9em; color: var(--sp-slate-light); margin-bottom: 5px;">Annual DD Payments</div>
                        <div style="font-size: 1.5em; font-weight: 700; color: var(--sp-slate);" id="annualDD">¬£1,800</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; color: var(--sp-slate-light); margin-bottom: 5px;">Estimated Annual Usage</div>
                        <div style="font-size: 1.5em; font-weight: 700; color: var(--sp-green);" id="annualUsage">¬£0</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; color: var(--sp-slate-light); margin-bottom: 5px;">Year-End Balance</div>
                        <div style="font-size: 1.5em; font-weight: 700;" id="yearEndBalance">¬£0</div>
                    </div>
                </div>
            </div>

            <div style="background: var(--sp-green-light); border-left: 4px solid var(--sp-green); padding: 15px; border-radius: 8px; font-size: 0.9em;">
                <strong>üí° Understanding Your Direct Debit:</strong> Energy suppliers set your monthly DD to cover your average annual usage. In summer, when you use less energy, you build up credit. In winter, when heating kicks in, you use that credit. This explains why your DD stays the same but your usage varies dramatically by season.
            </div>
        </div>

        <div style="text-align: center; margin-bottom: 30px;">
            <a href="tariff-tracker.html" style="display: inline-block; padding: 12px 24px; background: var(--sp-green); color: white; text-decoration: none; border-radius: 8px; font-weight: 600; transition: transform 0.2s ease, background 0.2s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.background='#059669'" onmouseout="this.style.transform='translateY(0)'; this.style.background='#10B981'">
                üìä View Current Tariff Rates
            </a>
        </div>

        <!-- FUEL SECTIONS SIDE BY SIDE -->
        <div class="fuel-sections-wrapper">
            <!-- ELECTRICITY SECTION -->
            <div class="fuel-section">
                <h2><span class="fuel-icon">‚ö°</span> Electricity Usage</h2>
                
                <div class="rate-inputs">
                    <div class="input-group">
                        <label for="elecRate">Electricity Unit Rate (p/kWh)</label>
                        <input type="number" id="elecRate" value="27.69" step="0.01" min="0" oninput="calculateAll()">
                    </div>
                    <div class="input-group">
                        <label for="elecStanding">Electricity Standing Charge (p/day)</label>
                        <input type="number" id="elecStanding" value="54.75" step="0.01" min="0" oninput="calculateAll()">
                    </div>
                </div>

                <div id="elecAppliances"></div>

                <div id="funNote" style="display: none; background: linear-gradient(135deg, #fef3f2 0%, #f0e7ff 100%); border-left: 4px solid #ec4899; padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <strong>üéâ Essential Additions:</strong> These are additional appliances you might have in your home. From crypto mining rigs to hot tubs, see how they impact your bill!
                </div>
            </div>

            <!-- GAS SECTION -->
            <div class="fuel-section">
                <h2><span class="fuel-icon">üî•</span> Gas Usage</h2>
                
                <div class="rate-inputs">
                    <div class="input-group">
                        <label for="gasRate">Gas Unit Rate (p/kWh)</label>
                        <input type="number" id="gasRate" value="5.90" step="0.01" min="0" oninput="calculateAll()">
                    </div>
                    <div class="input-group">
                        <label for="gasStanding">Gas Standing Charge (p/day)</label>
                        <input type="number" id="gasStanding" value="35.10" step="0.01" min="0" oninput="calculateAll()">
                    </div>
                </div>

                <div id="gasAppliances"></div>
            </div>
        </div>

        <div class="note">
            <strong>Note:</strong> This calculator uses typical appliance power ratings and your estimated usage patterns. Actual costs may vary based on appliance efficiency, usage patterns, and your specific tariff rates. Default rates shown are based on the January 2026 Ofgem price cap.
        </div>

        <div class="note">
            <strong>Verification of Consumption Values:</strong> All power consumption figures used in this calculator have been verified against multiple authoritative UK sources including:
            <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                <li>Ofgem (UK energy regulator) - typical domestic consumption values</li>
                <li>Energy Saving Trust - appliance energy efficiency data</li>
                <li>UK government Department for Business, Energy & Industrial Strategy (BEIS)</li>
                <li>Centre for Sustainable Energy</li>
                <li>Multiple UK energy suppliers (British Gas, OVO Energy, etc.)</li>
            </ul>
            Power ratings represent typical UK household appliances as of January 2025. Individual appliance specifications may vary by model, age, and efficiency rating.
        </div>

        <footer style="text-align: center; margin-top: 50px; padding: 30px 20px; background: var(--sp-slate); color: white; border-radius: 0;">
            <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px;">
                <span style="font-size: 1.6rem;">‚ö°</span>
                <span style="font-size: 1.35rem; font-weight: 700;">SwitchPilot</span>
            </div>
            <p style="color: #94A3B8; margin-bottom: 5px; font-weight: 500;">Putting the power back in your hands</p>
            <p style="color: #64748B; font-size: 0.9em;">Transparent energy education for UK households</p>
        </footer>
    </div>

    <script>
        const gasAppliances = [
            { name: 'Gas Hob', power: 2.0, unit: 'hours/day', max: 4, default: 0.5, id: 'hob' },
            { name: 'Gas Oven', power: 2.5, unit: 'hours/day', max: 4, default: 0.5, id: 'oven' },
            { name: 'Gas Shower', power: 10.0, unit: 'minutes/day', max: 120, default: 20, id: 'shower' },
            { name: 'Gas Central Heating (Winter)', power: 15.0, unit: 'hours/day', max: 24, default: 4, id: 'heatingWinter', seasonal: 'winter', note: '‚ùÑÔ∏è' },
            { name: 'Gas Central Heating (Summer)', power: 15.0, unit: 'hours/day', max: 24, default: 0.5, id: 'heatingSummer', seasonal: 'summer', note: '‚òÄÔ∏è' }
        ];

        const elecAppliances = [
            { name: 'Fridge/Freezer', power: 0.15, unit: 'hours/day', max: 24, default: 24, id: 'fridge', note: '(always on)', isFun: false },
            { name: 'LED Lights', power: 0.06, unit: 'hours/day', max: 24, default: 6, id: 'lights', isFun: false },
            { name: 'TV', power: 0.1, unit: 'hours/day', max: 24, default: 4, id: 'tv', isFun: false },
            { name: 'Laptop/Computer', power: 0.075, unit: 'hours/day', max: 24, default: 6, id: 'computer', isFun: false },
            { name: 'Phone Charging', power: 0.012, unit: 'charges/day', max: 10, default: 2, id: 'phone', isFun: false },
            { name: 'Washing Machine', power: 1.5, unit: 'loads/week', max: 14, default: 4, id: 'washing', isFun: false },
            { name: 'Dishwasher', power: 1.2, unit: 'loads/week', max: 14, default: 3, id: 'dishwasher', isFun: false },
            { name: 'Microwave', power: 0.8, unit: 'uses/day', max: 10, default: 0, id: 'microwave', isFun: false },
            { name: 'Kettle (Electric)', power: 0.15, unit: 'boils/day', max: 20, default: 4, id: 'ekettle', isFun: false },
            { name: 'Immersion Heater', power: 3.0, unit: 'hours/day', max: 12, default: 0, id: 'immersion', isFun: false },
            { name: 'Electric Heating', power: 2.0, unit: 'hours/day', max: 24, default: 0, id: 'eheating', isFun: false },
            { name: 'Electric Shower', power: 1.5, unit: 'minutes/day', max: 120, default: 0, id: 'eshower', isFun: false },
            { name: 'EV Charger', power: 7.0, unit: 'hours/week', max: 50, default: 0, id: 'evcharger', note: '', isFun: false },
            // Essential additions
            { name: 'Crypto Mining Rig', power: 3.5, unit: 'hours/day', max: 24, default: 0, id: 'crypto', note: '', isFun: true },
            { name: 'Gaming PC Setup', power: 0.5, unit: 'hours/day', max: 24, default: 0, id: 'gamingpc', note: '(RTX 4090)', isFun: true },
            { name: 'Hot Tub', power: 7.5, unit: 'hours/day', max: 24, default: 0, id: 'hottub', note: '', isFun: true },
            { name: 'Aquarium with Heater', power: 0.15, unit: 'hours/day', max: 24, default: 0, id: 'aquarium', note: '', isFun: true },
            { name: 'Electric Blanket', power: 0.1, unit: 'hours/day', max: 12, default: 0, id: 'blanket', note: '', isFun: true },
            { name: 'Arcade Machine', power: 0.3, unit: 'hours/day', max: 24, default: 0, id: 'arcade', note: '', isFun: true },
            { name: 'Christmas Lights', power: 0.025, unit: 'hours/day', max: 24, default: 0, id: 'xmaslights', note: '', isFun: true },
            { name: 'Beer/Wine Fridge', power: 0.1, unit: 'hours/day', max: 24, default: 0, id: 'beerfridge', note: '', isFun: true },
            { name: 'Electric Dehumidifier', power: 0.5, unit: 'hours/day', max: 24, default: 0, id: 'dehumidifier', isFun: true }
        ];

        let currentPeriod = 'day';
        let periodMultiplier = 1;
        let showFunAppliances = false;
        let currentSeason = 'summer'; // Which season to display for daily/weekly/monthly

        function formatCurrency(amount) {
            const formatted = amount.toFixed(2);
            const parts = formatted.split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            return `¬£${parts.join('.')}`;
        }

        function setSeason(season) {
            currentSeason = season;
            
            // Update button states
            document.querySelectorAll('.season-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (season === 'summer') {
                document.getElementById('summerBtn').classList.add('active');
                document.getElementById('seasonLabel').textContent = 'Summer';
            } else {
                document.getElementById('winterBtn').classList.add('active');
                document.getElementById('seasonLabel').textContent = 'Winter';
            }
            
            calculateAll();
        }

        function createAppliances() {
            const gasContainer = document.getElementById('gasAppliances');
            const elecContainer = document.getElementById('elecAppliances');

            gasAppliances.forEach(app => {
                const div = document.createElement('div');
                div.className = 'appliance';
                const noteText = app.note || '';
                div.innerHTML = `
                    <div class="appliance-header">
                        <span class="appliance-name">${app.name} ${noteText}</span>
                        <span class="appliance-power">${app.power} kWh per ${app.unit.split('/')[0]}</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="${app.id}" min="0" max="${app.max}" value="${app.default}" step="0.1" oninput="updateAppliance('${app.id}', 'gas')">
                    </div>
                    <div class="usage-display">
                        <span><span id="${app.id}-value">${app.default}</span> ${app.unit}</span>
                        <span class="cost-display" id="${app.id}-cost">¬£0.00</span>
                    </div>
                `;
                gasContainer.appendChild(div);
            });

            elecAppliances.forEach(app => {
                const div = document.createElement('div');
                div.className = app.isFun ? 'appliance fun-appliance' : 'appliance';
                if (app.isFun) {
                    div.style.display = 'none';
                }
                const noteText = app.note || '';
                div.innerHTML = `
                    <div class="appliance-header">
                        <span class="appliance-name">${app.name} ${noteText}</span>
                        <span class="appliance-power">${app.power} kWh per ${app.unit.split('/')[0]}</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="${app.id}" min="0" max="${app.max}" value="${app.default}" step="0.1" oninput="updateAppliance('${app.id}', 'elec')">
                    </div>
                    <div class="usage-display">
                        <span><span id="${app.id}-value">${app.default}</span> ${app.unit}</span>
                        <span class="cost-display" id="${app.id}-cost">¬£0.00</span>
                    </div>
                `;
                elecContainer.appendChild(div);
            });
        }

        function updateAppliance(id, type) {
            const value = document.getElementById(id).value;
            document.getElementById(`${id}-value`).textContent = parseFloat(value).toFixed(1);
            calculateAll();
        }

        function toggleFunAppliances() {
            showFunAppliances = !showFunAppliances;
            const funAppliances = document.querySelectorAll('.fun-appliance');
            const toggleBtn = document.getElementById('funToggle');
            const funNote = document.getElementById('funNote');
            
            funAppliances.forEach(appliance => {
                appliance.style.display = showFunAppliances ? 'block' : 'none';
            });

            funNote.style.display = showFunAppliances ? 'block' : 'none';

            if (showFunAppliances) {
                toggleBtn.textContent = 'üòé Hide Essential Additions';
                toggleBtn.style.background = '#059669';
            } else {
                toggleBtn.textContent = 'üéâ Show Essential Additions';
                toggleBtn.style.background = '#10B981';
            }
        }

        function setPeriod(period) {
            currentPeriod = period;
            
            // Update button states
            document.querySelectorAll('.period-btn:not(.season-btn)').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Set multiplier
            if (period === 'day') periodMultiplier = 1;
            else if (period === 'week') periodMultiplier = 7;
            else if (period === 'month') periodMultiplier = 30;
            else if (period === 'year') periodMultiplier = 365;

            // Show/hide season toggle
            const seasonToggle = document.getElementById('seasonToggle');
            const seasonNote = document.getElementById('seasonNote');
            
            if (period === 'year') {
                // Hide season toggle for annual view
                seasonToggle.style.display = 'none';
                seasonNote.style.display = 'none';
            } else {
                // Show season toggle for daily/weekly/monthly
                seasonToggle.style.display = 'flex';
                seasonNote.style.display = 'block';
            }

            calculateAll();
        }

        function calculateAll() {
            const gasRate = parseFloat(document.getElementById('gasRate').value) / 100;
            const gasStanding = parseFloat(document.getElementById('gasStanding').value) / 100;
            const elecRate = parseFloat(document.getElementById('elecRate').value) / 100;
            const elecStanding = parseFloat(document.getElementById('elecStanding').value) / 100;

            let totalGasUsage = 0;
            let totalElecUsage = 0;

            // Calculate gas appliances
            gasAppliances.forEach(app => {
                const value = parseFloat(document.getElementById(app.id).value);
                let dailyKwh = 0;

                if (app.unit.includes('hours')) {
                    dailyKwh = value * app.power;
                } else if (app.unit.includes('minutes')) {
                    dailyKwh = (value / 60) * app.power;
                } else if (app.unit.includes('boils') || app.unit.includes('uses')) {
                    dailyKwh = value * app.power;
                }

                let periodKwh = 0;
                
                // Handle seasonal heating
                if (app.seasonal) {
                    if (currentPeriod === 'year') {
                        // Annual: include this season's contribution
                        if (app.seasonal === 'winter') {
                            periodKwh = dailyKwh * 120; // 4 months
                        } else {
                            periodKwh = dailyKwh * 245; // 8 months
                        }
                    } else {
                        // Daily/Weekly/Monthly: only show if this matches current season
                        if (app.seasonal === currentSeason) {
                            periodKwh = dailyKwh * periodMultiplier;
                        } else {
                            periodKwh = 0; // Don't count the other season
                        }
                    }
                } else {
                    // Non-seasonal appliances: always use standard calculation
                    periodKwh = dailyKwh * periodMultiplier;
                }
                
                const cost = periodKwh * gasRate;
                totalGasUsage += cost;

                document.getElementById(`${app.id}-cost`).textContent = formatCurrency(cost);
            });

            // Calculate electricity appliances
            elecAppliances.forEach(app => {
                const value = parseFloat(document.getElementById(app.id).value);
                let dailyKwh = 0;

                if (app.unit.includes('week')) {
                    // Weekly usage items
                    dailyKwh = (value / 7) * app.power;
                } else if (app.unit.includes('hours')) {
                    dailyKwh = value * app.power;
                } else if (app.unit.includes('minutes')) {
                    dailyKwh = (value / 60) * app.power;
                } else if (app.unit.includes('charges') || app.unit.includes('boils') || app.unit.includes('uses')) {
                    dailyKwh = value * app.power;
                }

                const periodKwh = dailyKwh * periodMultiplier;
                const cost = periodKwh * elecRate;
                totalElecUsage += cost;

                document.getElementById(`${app.id}-cost`).textContent = formatCurrency(cost);
            });

            // Calculate standing charges
            const gasStandingTotal = gasStanding * periodMultiplier;
            const elecStandingTotal = elecStanding * periodMultiplier;

            // Update summary
            document.getElementById('gasUsageCost').textContent = formatCurrency(totalGasUsage);
            document.getElementById('gasStandingCost').textContent = formatCurrency(gasStandingTotal);
            document.getElementById('elecUsageCost').textContent = formatCurrency(totalElecUsage);
            document.getElementById('elecStandingCost').textContent = formatCurrency(elecStandingTotal);

            const grandTotal = totalGasUsage + gasStandingTotal + totalElecUsage + elecStandingTotal;
            document.getElementById('totalCost').textContent = formatCurrency(grandTotal);

            // Calculate annual usage for Direct Debit comparison (always based on daily usage)
            calculateAnnualComparison();
        }

        function calculateAnnualComparison() {
            const gasRate = parseFloat(document.getElementById('gasRate').value) / 100;
            const gasStanding = parseFloat(document.getElementById('gasStanding').value) / 100;
            const elecRate = parseFloat(document.getElementById('elecRate').value) / 100;
            const elecStanding = parseFloat(document.getElementById('elecStanding').value) / 100;
            
            const ddAmount = parseFloat(document.getElementById('ddAmount').value) || 0;
            const annualDD = ddAmount * 12;
            
            // Calculate daily totals from appliances
            let dailyGasUsage = 0;
            let dailyElecUsage = 0;
            
            gasAppliances.forEach(app => {
                const value = parseFloat(document.getElementById(app.id).value);
                let dailyKwh = 0;
                if (app.unit.includes('hours')) {
                    dailyKwh = value * app.power;
                } else if (app.unit.includes('minutes')) {
                    dailyKwh = (value / 60) * app.power;
                } else if (app.unit.includes('boils') || app.unit.includes('uses')) {
                    dailyKwh = value * app.power;
                }
                
                // For seasonal heating, calculate based on their seasonal duration
                let annualKwh = 0;
                if (app.seasonal === 'winter') {
                    annualKwh = dailyKwh * 120; // 4 months = 120 days
                } else if (app.seasonal === 'summer') {
                    annualKwh = dailyKwh * 245; // 8 months = 245 days
                } else {
                    annualKwh = dailyKwh * 365;
                }
                
                dailyGasUsage += (annualKwh / 365) * gasRate;
            });
            
            elecAppliances.forEach(app => {
                const value = parseFloat(document.getElementById(app.id).value);
                let dailyKwh = 0;
                if (app.unit.includes('week')) {
                    dailyKwh = (value / 7) * app.power;
                } else if (app.unit.includes('hours')) {
                    dailyKwh = value * app.power;
                } else if (app.unit.includes('minutes')) {
                    dailyKwh = (value / 60) * app.power;
                } else if (app.unit.includes('charges') || app.unit.includes('boils') || app.unit.includes('uses')) {
                    dailyKwh = value * app.power;
                }
                dailyElecUsage += dailyKwh * elecRate;
            });
            
            // Calculate annual usage based on daily usage √ó 365
            const annualUsage = (dailyGasUsage + dailyElecUsage) * 365;
            const annualStanding = (gasStanding + elecStanding) * 365;
            const estimatedAnnualUsage = annualUsage + annualStanding;
            
            // Calculate year-end balance
            const yearEndBalance = annualDD - estimatedAnnualUsage;
            
            // Update display
            document.getElementById('annualDD').textContent = formatCurrency(annualDD).replace('.00', '');
            document.getElementById('annualUsage').textContent = formatCurrency(estimatedAnnualUsage).replace('.00', '');
            
            const balanceElement = document.getElementById('yearEndBalance');
            
            if (yearEndBalance > 0) {
                balanceElement.style.color = 'var(--sp-green)';
                balanceElement.textContent = '+' + formatCurrency(yearEndBalance).replace('.00', '');
            } else if (yearEndBalance < 0) {
                balanceElement.style.color = '#EF4444';
                balanceElement.textContent = '-' + formatCurrency(Math.abs(yearEndBalance)).replace('.00', '');
            } else {
                balanceElement.style.color = 'var(--sp-slate)';
                balanceElement.textContent = formatCurrency(0).replace('.00', '');
            }
        }

        // Initialize
        createAppliances();
        calculateAll();
    </script>
</body>
</html>
